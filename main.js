(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,o){for(var n=0;n<o.length;n++){var r=o[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,o){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===t(i)?i:String(i)),r)}var i}var o=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data=e,this._form=o,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._errorClass=e.errorClass,this._invalidInputClass=e.invalidInputClass,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=document.querySelector(this._submitButtonSelector)}var o,n;return o=t,(n=[{key:"_showInputError",value:function(t,e){var o=this._form.querySelector(".".concat(t.id,"-error"));t.classList.add(this._invalidInputClass),o.textContent=e,o.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(t){var e=this._form.querySelector(".".concat(t.id,"-error"));t.classList.remove(this._invalidInputClass),e.classList.remove(this._errorClass),e.textContent=""}},{key:"_checkInputValidity",value:function(t){t.validity.valid||"name"!==t.name?t.validity.valid||"surname"!==t.name?t.validity.valid||"email"!==t.name||""!=t.value?t.validity.valid||"email"!==t.name||/^([^ ]+@[^ ]+\\.[a-z]{2,4}|)$/.test(t.value)?t.validity.valid||"phone"!==t.name||""!=t.value?t.validity.valid||"phone"!==t.name||/^\+[1-9] \d{3} \d{3} \d{2} \d{2}$/.test(t.value)?t.validity.valid||"inn"!==t.name||""!=t.value?t.validity.valid||"inn"!==t.name||/^\d{14}$/.test(t.value)?this._hideInputError(t):this._showInputError(t,t.textContent="Проверьте ИНН"):this._showInputError(t,t.textContent="Укажите ИНН"):this._showInputError(t,t.textContent="Формат: +9 999 999 99 99"):this._showInputError(t,t.textContent="Укажите номер телефона"):this._showInputError(t,t.textContent="Проверьте электронную почту"):this._showInputError(t,t.textContent="Укажите электронную почту"):this._showInputError(t,t.textContent="Введите фамилию"):this._showInputError(t,t.textContent="Укажите имя")}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(t){return!t.validity.valid}))}},{key:"_setEventListeners",value:function(){var t=this;this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e)}))})),this._inputList.forEach((function(e){e.addEventListener("focusout",(function(){t._hideInputError(e)}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&e(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),t}(),n=document.querySelector(".basket__order-button"),r=document.querySelector(".basket__form"),i=document.querySelector(".basket__input_name_phone"),s=document.querySelector("#checkbox-payment"),a=document.querySelector(".basket__whole-sum"),c=document.querySelectorAll(".basket__goods-data"),u=document.querySelector(".basket__goods-hide_type_stock"),l=document.querySelector(".basket__goods-hide_type_out"),d=document.querySelector(".basket__goods-content_type_stock"),_=document.querySelector(".basket__goods-content_type_out"),p=document.querySelector(".basket__goods-choose_type_choose"),f=document.querySelector(".basket__goods-summary"),y=document.querySelector(".goods-delivery__change"),v=document.querySelector(".basket__delivery-edit");function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function b(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==h(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===h(r)?r:String(r)),n)}var r}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function k(t,e){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},k(t,e)}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k(t,e)}(i,t);var e,o,n,r=(o=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=S(o);if(n){var r=S(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popup=document.querySelector(e),this._handleEsc=this._handleEscClose.bind(this)}var e,o;return e=t,(o=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEsc)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEsc)}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("mousedown",(function(e){(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&t.close()}))}}])&&b(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}());i.addEventListener("keyup",(function(t){[2,6,10,13].includes(t.target.value.length)&&"Backspace"!==t.key&&(t.target.value+=" ")}));var L=new o({formSelector:".basket__form",inputSelector:".basket__input",submitButtonSelector:".basket__order-button",inactiveButtonClass:"basket__order-button_disabled",errorClass:"basket__error_visible",invalidInputClass:"basket__input_invalid"},r);L.enableValidation(),n.addEventListener("click",(function(){L.enableValidation()}));var g=a.innerHTML;s.addEventListener("change",(function(){n.textContent=s.checked?"Оплатить ".concat(g," сом"):"Заказать"}));var w=new E(".popup_type_company");w.setEventListeners(),c.forEach((function(t){t.addEventListener("click",(function(){w.open()}))}));var C=new E(".popup_type_delivery");C.setEventListeners(),y.addEventListener("click",(function(){C.open()})),v.addEventListener("click",(function(){C.open()})),u.addEventListener("click",(function(){u.classList.contains("basket__goods-hide_active")?(u.classList.remove("basket__goods-hide_active"),d.classList.remove("basket__goods-content_unactive"),p.classList.remove("basket__goods-choose_type_unactive"),f.classList.remove("basket__goods-summary_active")):(u.classList.add("basket__goods-hide_active"),d.classList.add("basket__goods-content_unactive"),p.classList.add("basket__goods-choose_type_unactive"),f.classList.add("basket__goods-summary_active"))})),l.addEventListener("click",(function(){l.classList.contains("basket__goods-hide_active")?(l.classList.remove("basket__goods-hide_active"),_.classList.remove("basket__goods-content_unactive")):(l.classList.add("basket__goods-hide_active"),_.classList.add("basket__goods-content_unactive"))}))})();